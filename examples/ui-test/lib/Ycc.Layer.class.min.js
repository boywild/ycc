!function(a){var b=0;a.Layer=function(c,d){a.Listener.call(this);var e={name:"",type:"ui",x:0,y:0,width:c.getStageWidth(),height:c.getStageHeight(),show:!0,enableEventManager:!1,enableFrameEvent:!1,ctxConfig:{fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontSize:"16px",fontFamily:"微软雅黑",font:"16px 微软雅黑",textBaseline:"top",fillStyle:"red",strokeStyle:"blue"}},f=a.utils.extend(e,d,!0),g=document.createElement("canvas");g.width=f.width,g.height=f.height,this.option=f,this.uiList=[],this.ctxConfig=f.ctxConfig,this.config=f,this.yccInstance=c,this.canvasDom=g,this.canvasDom._props={},this.ctx=this.canvasDom.getContext("2d"),this.id=b++,this.type=f.type,this.textValue="",this.name=f.name?f.name:"图层_"+this.type+"_"+this.id,this.x=f.x,this.y=f.y,this.width=f.width,this.height=f.height,this.show=f.show,this.enableEventManager=f.enableEventManager,this.enableFrameEvent=f.enableFrameEvent,this.onFrameComing=function(){},this.init()},a.Layer.prototype=new a.Listener,a.Layer.prototype.constructor=a.Layer,a.Layer.prototype.init=function(){var b=this;if(!this.ctxConfig||!a.utils.isObj(this.ctxConfig))return null;b._setCtxProps(),b._initEvent();var c=this.ctxConfig;for(var d in c)c.hasOwnProperty(d)&&Object.defineProperty(this.ctx.canvas._props,d,{enumerable:!0,configurable:!0,set:function(a){return function(c){b.ctxConfig[a]=c,b._setCtxProps()}}(d),get:function(a){return function(){return b.ctxConfig[a]}}(d)})},a.Layer.prototype._initEvent=function(){function b(b){if(!b.stop&&!(e&&b.x===e.x&&b.y===e.y||f&&b.x===f.x&&b.y===f.y)){if(g=!0,e&&e.target){var c=new a.Event("dragging");c.target=e.target,c.x=b.x,c.y=b.y,c.mouseDownYccEvent=e,c.target.triggerListener(c.type,c)}for(var h=d.uiList.length-1;h>=0;h--){var i=d.uiList[h],j=new a.Math.Dot(b.x-i.belongTo.x,b.y-i.belongTo.y);if(j.isInRect(i.option.rect)){b.stop=!0,b.mouseDownYccEvent=e,b.mouseUpYccEvent=f,b.target=i,i.triggerListener(b.type,b);break}}}}function c(b){if(!b.stop)for(var c=d.uiList.length-1;c>=0;c--){var g=d.uiList[c],h=b.x-g.belongTo.x,i=b.y-g.belongTo.y,j=new a.Math.Dot(h,i);if(j.isInRect(g.option.rect)&&b.stop===!1){b.stop=!0,b.mouseDownYccEvent=e,b.mouseUpYccEvent=f,b.target=g,b.targetDeltaPosition=new a.Math.Dot(b.x-g.option.rect.x,b.y-g.option.rect.y),g.triggerListener(b.type,b);break}}}var d=this,e=null,f=null,g=!1;this.addListener("click",function(a){g||c(a)}),this.addListener("mousedown",function(a){g=!1,e=a,c(a)}),this.addListener("mouseup",function(a){a.mouseDownYccEvent=e=null,f=a,c(a)}),this.addListener("mousemove",b)},a.Layer.prototype._setCtxProps=function(){var a=this,b=this.ctxConfig;b.font=[b.fontStyle,b.fontVariant,b.fontWeight,b.fontSize,b.fontFamily].join(" ");for(var c in a.ctxConfig)a.ctxConfig.hasOwnProperty(c)&&(a.ctx[c]=a.ctxConfig[c])},a.Layer.prototype.clear=function(){this.ctx.clearRect(0,0,this.width,this.height)},a.Layer.prototype.renderToStage=function(){this.show&&this.yccInstance.ctx.drawImage(this.canvasDom,0,0,this.width,this.height)},a.Layer.prototype.addUI=function(a){a.init(this),a.render(),this.uiList.push(a)},a.Layer.prototype.render=function(){for(var a=0;a<this.uiList.length;a++)this.uiList[a].render()},a.Layer.prototype.reRender=function(){this.clear(),this.render()}}(window.Ycc);
//# sourceMappingURL=Ycc.Layer.class.min.js.map